# دليل الإعداد - تطبيق إدارة العلاج الدوائي

## المتطلبات

- Node.js (v16 أو أحدث)
- npm أو yarn
- حساب Supabase

## خطوات الإعداد

### 1. استنساخ المستودع
```bash
cd /path/to/project
npm install
```

### 2. إعداد متغيرات البيئة

انسخ ملف `.env.example` إلى `.env`:
```bash
cp .env.example .env
```

أضف معلومات Supabase:
```
EXPO_PUBLIC_SUPABASE_URL=your_supabase_url
EXPO_PUBLIC_SUPABASE_ANON_KEY=your_anon_key
```

احصل على هذه المعلومات من:
1. اذهب إلى https://supabase.com/dashboard
2. اختر مشروعك
3. اذهب إلى Settings > API
4. انسخ `Project URL` و `anon public key`

### 3. التحقق من الإعدادات

```bash
npm run typecheck
```

يجب أن تكون النتيجة خالية من الأخطاء.

### 4. تشغيل التطبيق

```bash
npm run dev
```

### 5. الوصول إلى التطبيق

افتح المتصفح على:
```
http://localhost:8081
```

---

## قاعدة البيانات

تم إنشاء جميع الجداول والسياسات تلقائيًا عند تشغيل migration:

- `profiles` - معلومات المستخدمين
- `patients` - بيانات المرضى
- `patient_team` - فريق كل مريض
- `medications` - الأدوية الموصوفة
- `dose_logs` - سجل الجرعات
- `dose_notes` - ملاحظات الجرعات
- `dose_images` - صور العبوات
- `adherence_scores` - درجات الالتزام

### تشغيل Migration

Migration تم تطبيقها تلقائيًا عند إنشاء التطبيق.

---

## الحسابات الاختبارية

### إنشاء حساب جديد

1. اذهب إلى صفحة التسجيل
2. اختر الدور:
   - **طبيب**: لإدارة الأدوية والفريق
   - **معين**: لتأكيد الجرعات
   - **مريض**: لعرض الجدول فقط

3. أدخل البيانات والبريد والكلمة

### الدخول

استخدم البريد والكلمة التي سجلت بها.

---

## هيكل المشروع

```
project/
├── app/
│   ├── (auth)/              # شاشات المصادقة
│   │   ├── login.tsx
│   │   ├── register.tsx
│   │   └── _layout.tsx
│   ├── (tabs)/              # الشاشات الرئيسية
│   │   ├── index.tsx        # المرضى/الرئيسية
│   │   ├── medications.tsx  # الأدوية
│   │   ├── adherence.tsx    # الالتزام
│   │   ├── settings.tsx     # الإعدادات
│   │   └── _layout.tsx      # تخطيط التبويبات
│   ├── _layout.tsx          # التخطيط الرئيسي
│   └── index.tsx            # شاشة التوجيه
├── components/              # المكونات المشتركة
│   ├── MedicationForm.tsx   # نموذج إضافة/تعديل الأدوية
│   └── DoseLogger.tsx       # مكون تسجيل الجرعات
├── contexts/                # Context API
│   ├── AuthContext.tsx      # المصادقة والجلسة
│   └── LanguageContext.tsx  # إدارة اللغة
├── lib/
│   ├── supabase.ts          # اتصال Supabase
│   └── i18n.ts              # الترجمات
├── hooks/                   # الـ Hooks
│   └── useFrameworkReady.ts # الإعداد الأولي
├── types/
│   └── env.d.ts             # تعريفات متغيرات البيئة
├── supabase/
│   ├── migrations/          # ملفات الـ migrations
│   └── functions/           # Edge Functions
└── assets/                  # الصور والأيقونات
```

---

## الميزات الرئيسية

### ✅ المصادقة
- إنشاء حساب جديد
- تسجيل دخول آمن
- ثلاثة أدوار رئيسية

### ✅ إدارة المرضى
- إضافة مرضى جدد
- تعيين فريق لكل مريض

### ✅ إدارة الأدوية
- إضافة / تعديل / حذف أدوية
- تحديد الجرعات والفواصل الزمنية

### ✅ تأكيد الجرعات
- تأكيد الجرعة بضغطة
- منع التعارض الزمني
- ملاحظات مفصلة (تقيء، تأجيل، رفض)

### ✅ مراقبة الالتزام
- درجة الالتزام اليومية
- مقارنة الأداء الأسبوعي
- رؤية الاتجاه

### ✅ دعم متعدد اللغات
- العربية والإنجليزية
- RTL للعربية

---

## استكشاف الأخطاء

### لا يعمل الاتصال بـ Supabase

- تحقق من URL و Key
- تأكد من أن المشروع مفعّل
- تحقق من الاتصال بالإنترنت

### خطأ في المصادقة

- تأكد من إدخال البريد الصحيح
- تحقق من كلمة المرور
- جرب إنشاء حساب جديد

### صور الكاميرا لا تعمل

- تحقق من أذونات الكاميرا
- أعد تحميل التطبيق
- جرب على جهاز آخر

---

## الأداء والأمان

- ✅ RLS على جميع الجداول
- ✅ تشفير البيانات الحساسة
- ✅ تحديثات فورية
- ✅ معالجة الأخطاء المحسّنة
- ✅ واجهة مستجيبة

---

## الدعم والمساعدة

للمزيد من المعلومات، راجع:
- `FEATURES.md` - قائمة كاملة بالميزات
- `app/` - مصدر التطبيق
- `supabase/migrations/` - إعدادات قاعدة البيانات

---

**ملاحظة مهمة**: لا تنسَ أن تحافظ على معلومات Supabase آمنة ولا تشاركها مع أحد.
